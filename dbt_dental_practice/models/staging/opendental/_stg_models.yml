version: 2

models:
  - name: stg_procedurelog
    description: "Standardized procedure records from OpenDental"
    columns:
      - name: procedure_id
        description: "Primary key for procedure records"
        tests:
          - unique
          - not_null

  - name: stg_payment
    description: "Standardized payment records from OpenDental"
    columns:
      - name: payment_id
        description: "Primary key for payment records"
        tests:
          - unique
          - not_null

  - name: stg_provider
    description: "Standardized provider information from OpenDental"
    columns:
      - name: provider_id
        description: "Primary key for provider records"
        tests:
          - unique
          - not_null

  - name: stg_adjustment
    description: "Standardized financial adjustment records from OpenDental"
    columns:
      - name: adjustment_id
        description: "Primary key for adjustment records"
        tests:
          - unique
          - not_null
      - name: patient_id
        description: "Foreign key to patient table"
        tests:
          - relationships:
              to: ref('stg_patient')
              field: patient_id
      - name: adjustment_amount
        description: "The monetary value of the adjustment"
      - name: adjustment_direction
        description: "Calculated field indicating if adjustment is positive, negative, or zero"
        tests:
          - accepted_values:
              values: ['positive', 'negative', 'zero']

  - name: stg_appointmenttype
    description: "Reference table for different types of appointments"
    columns:
      - name: appointment_type_id
        description: "Primary key for appointment types"
        tests:
          - unique
          - not_null
      - name: type_name
        description: "Name of the appointment type"
        tests:
          - not_null
      - name: duration_minutes
        description: "Calculated standard duration for this type of appointment"

  - name: stg_autocode
    description: "Automation codes for dental procedures"
    columns:
      - name: autocode_id
        description: "Primary key for autocodes"
        tests:
          - unique
          - not_null
      - name: description
        description: "Description of the autocode's purpose"

  - name: stg_benefit
    description: "Insurance benefit and coverage details"
    columns:
      - name: benefit_id
        description: "Primary key for benefits"
        tests:
          - unique
          - not_null
      - name: insurance_plan_id
        description: "Foreign key to insurance plan"
        tests:
          - relationships:
              to: ref('stg_insplan')
              field: insurance_plan_id
      - name: coverage_percent
        description: "Percentage of coverage for the benefit"
      - name: benefit_calculation_type
        description: "Indicates if benefit is calculated as monetary, percentage, or other"
        tests:
          - accepted_values:
              values: ['monetary', 'percentage', 'other']

  - name: stg_carrier
    description: "Insurance carrier information"
    columns:
      - name: carrier_id
        description: "Primary key for carriers"
        tests:
          - unique
          - not_null
      - name: carrier_name
        description: "Name of the insurance carrier"
        tests:
          - not_null
      - name: is_hidden
        description: "Flag indicating if carrier is hidden from active use"

  - name: stg_claim
    description: "Standardized insurance claim information"
    columns:
      - name: claim_id
        description: "Primary key for claims"
        tests:
          - unique
          - not_null
      - name: patient_id
        description: "Foreign key to patient"
        tests:
          - relationships:
              to: ref('stg_patient')
              field: patient_id
      - name: insurance_plan_id
        description: "Foreign key to primary insurance plan"
        tests:
          - relationships:
              to: ref('stg_insplan')
              field: insurance_plan_id
      - name: claim_status
        description: "Current status of the claim"
      - name: service_date
        description: "Date of service for the claim"
        tests:
          - not_null

  - name: stg_claimpayment
    description: "Insurance payment records for claims"
    columns:
      - name: claim_payment_id
        description: "Primary key for claim payments"
        tests:
          - unique
          - not_null
      - name: check_amount
        description: "Payment amount received"
      - name: payment_completion_status
        description: "Indicates if payment is partial or complete"
        tests:
          - accepted_values:
              values: ['Partial', 'Complete']

  - name: stg_claimproc
    description: "Procedures associated with insurance claims"
    columns:
      - name: claim_procedure_id
        description: "Primary key for claim procedures"
        tests:
          - unique
          - not_null
      - name: claim_id
        description: "Foreign key to claim"
        tests:
          - relationships:
              to: ref('stg_claim')
              field: claim_id
      - name: procedure_id
        description: "Foreign key to procedure"
        tests:
          - relationships:
              to: ref('stg_procedurelog')
              field: procedure_id
      - name: status_description
        description: "Descriptive status of the claim procedure"
        tests:
          - accepted_values:
              values: ['NotReceived', 'Received', 'NotSent', 'Supplemental', 'CapClaim', 'Preauth', 'Estimate', 'CapComplete', 'CapEstimate', 'Other', 'Unknown']

  - name: stg_claimtracking
    description: "Tracking information for insurance claims"
    columns:
      - name: claim_tracking_id
        description: "Primary key for claim tracking"
        tests:
          - unique
          - not_null
      - name: claim_id
        description: "Foreign key to claim"
        tests:
          - relationships:
              to: ref('stg_claim')
              field: claim_id
      - name: entry_datetime
        description: "Timestamp of tracking entry"
        tests:
          - not_null

  - name: stg_codegroup
    description: "Groups of procedure codes"
    columns:
      - name: code_group_id
        description: "Primary key for code groups"
        tests:
          - unique
          - not_null
      - name: group_name
        description: "Name of the code group"
        tests:
          - not_null
      - name: is_hidden
        description: "Flag indicating if group is hidden from active use"

  - name: stg_commlog
    description: "Communication log entries"
    columns:
      - name: communication_id
        description: "Primary key for communication logs"
        tests:
          - unique
          - not_null
      - name: patient_id
        description: "Foreign key to patient"
        tests:
          - relationships:
              to: ref('stg_patient')
              field: patient_id
      - name: communication_mode_description
        description: "Type of communication (Email, Voice, Mail, etc.)"
        tests:
          - accepted_values:
              values: ['None', 'Email', 'Voice', 'Mail', 'InPerson', 'Text', 'Other']
      - name: direction
        description: "Direction of communication"
        tests:
          - accepted_values:
              values: ['Sent', 'Received', 'Unknown']

  - name: stg_cpt
    description: "CPT (Current Procedural Terminology) codes"
    columns:
      - name: cpt_id
        description: "Primary key for CPT codes"
        tests:
          - unique
          - not_null
      - name: cpt_code
        description: "The actual CPT code"
        tests:
          - not_null
      - name: description
        description: "Description of the CPT code"

  - name: stg_definition
    description: "System definitions and configuration values"
    columns:
      - name: definition_id
        description: "Primary key for definitions"
        tests:
          - unique
          - not_null
      - name: category_id
        description: "Category identifier for the definition"
      - name: item_name
        description: "Name of the definition item"
        tests:
          - not_null

  - name: stg_document
    description: "Document and image records, excluding PHI content"
    columns:
      - name: document_id
        description: "Primary key for documents"
        tests:
          - unique
          - not_null
      - name: patient_id
        description: "Foreign key to patient"
        tests:
          - relationships:
              to: ref('stg_patient')
              field: patient_id
      - name: image_type
        description: "Type of document or image"
      - name: created_datetime
        description: "Creation timestamp of the document"
        tests:
          - not_null

  - name: stg_fee
    description: "Fee amounts for procedures"
    columns:
      - name: fee_id
        description: "Primary key for fees"
        tests:
          - unique
          - not_null
      - name: fee_schedule_id
        description: "Foreign key to fee schedule"
        tests:
          - relationships:
              to: ref('stg_feesched')
              field: fee_schedule_id
      - name: fee_amount
        description: "Amount charged for the procedure"
      - name: fee_type
        description: "Indicates if fee is default or custom"
        tests:
          - accepted_values:
              values: ['Default', 'Custom']

  - name: stg_feesched
    description: "Fee schedules for procedures"
    columns:
      - name: fee_schedule_id
        description: "Primary key for fee schedules"
        tests:
          - unique
          - not_null
      - name: fee_schedule_name
        description: "Name of the fee schedule"
        tests:
          - not_null
      - name: status
        description: "Active status of the fee schedule"
        tests:
          - accepted_values:
              values: ['Hidden', 'Active']

  - name: stg_feeschedgroup
    description: "Groups of fee schedules"
    columns:
      - name: fee_schedule_group_id
        description: "Primary key for fee schedule groups"
        tests:
          - unique
          - not_null
      - name: fee_schedule_id
        description: "Foreign key to fee schedule"
        tests:
          - relationships:
              to: ref('stg_feesched')
              field: fee_schedule_id

  - name: stg_histappointment
    description: "Historical appointment records and changes"
    columns:
      - name: appointment_history_id
        description: "Primary key for appointment history"
        tests:
          - unique
          - not_null
      - name: appointment_id
        description: "Foreign key to appointment"
        tests:
          - relationships:
              to: ref('stg_appointment')
              field: appointment_id
      - name: history_timestamp
        description: "When the historical record was created"
        tests:
          - not_null
      - name: history_action_type
        description: "Type of change made to the appointment"

  - name: stg_insbluebook
    description: "Insurance payment history and allowed amounts"
    columns:
      - name: insurance_bluebook_id
        description: "Primary key for insurance bluebook"
        tests:
          - unique
          - not_null
      - name: carrier_id
        description: "Foreign key to insurance carrier"
        tests:
          - relationships:
              to: ref('stg_carrier')
              field: carrier_id
      - name: insurance_payment_amount
        description: "Amount paid by insurance"

  - name: stg_insbluebooklog
    description: "Logging of insurance bluebook changes"
    columns:
      - name: insurance_bluebook_log_id
        description: "Primary key for insurance bluebook logs"
        tests:
          - unique
          - not_null
      - name: claim_procedure_id
        description: "Foreign key to claim procedure"
        tests:
          - relationships:
              to: ref('stg_claimproc')
              field: claim_procedure_id
      - name: allowed_fee_amount
        description: "Allowed fee amount for the procedure"

  - name: stg_insplan
    description: "Insurance plan configuration and details"
    columns:
      - name: insurance_plan_id
        description: "Primary key for insurance plans"
        tests:
          - unique
          - not_null
      - name: carrier_id
        description: "Foreign key to insurance carrier"
        tests:
          - relationships:
              to: ref('stg_carrier')
              field: carrier_id
      - name: fee_schedule_id
        description: "Foreign key to fee schedule"
        tests:
          - relationships:
              to: ref('stg_feesched')
              field: fee_schedule_id
      - name: employer_id
        description: "Foreign key to employer"
      - name: is_medical
        description: "Flag indicating if this is medical insurance"

  - name: stg_inssub
    description: "Insurance subscriber information"
    columns:
      - name: insurance_subscriber_id
        description: "Primary key for insurance subscribers"
        tests:
          - unique
          - not_null
      - name: insurance_plan_id
        description: "Foreign key to insurance plan"
        tests:
          - relationships:
              to: ref('stg_insplan')
              field: insurance_plan_id
      - name: subscriber_id
        description: "External subscriber identifier"
      - name: effective_date
        description: "Start date of coverage"
      - name: termination_date
        description: "End date of coverage"

  - name: stg_insverify
    description: "Insurance verification tracking"
    columns:
      - name: insurance_verify_id
        description: "Primary key for insurance verification"
        tests:
          - unique
          - not_null
      - name: last_verified_date
        description: "Date of last verification"
      - name: verify_type
        description: "Type of verification performed"
      - name: hours_available
        description: "Hours available for verification"
        tests:
          - not_null

  - name: stg_insverifyhist
    description: "Historical insurance verification records"
    columns:
      - name: insurance_verify_history_id
        description: "Primary key for verification history"
        tests:
          - unique
          - not_null
      - name: insurance_verify_id
        description: "Foreign key to insurance verification"
        tests:
          - relationships:
              to: ref('stg_insverify')
              field: insurance_verify_id
      - name: verify_user_id
        description: "User who performed verification"
      - name: history_timestamp
        description: "When the verification occurred"
        tests:
          - not_null

  - name: stg_labcase
    description: "Laboratory case tracking"
    columns:
      - name: lab_case_id
        description: "Primary key for lab cases"
        tests:
          - unique
          - not_null
      - name: patient_id
        description: "Foreign key to patient"
        tests:
          - relationships:
              to: ref('stg_patient')
              field: patient_id
      - name: provider_id
        description: "Foreign key to provider"
        tests:
          - relationships:
              to: ref('stg_provider')
              field: provider_id
      - name: lab_fee
        description: "Fee charged for lab work"
      - name: due_datetime
        description: "When the lab case is due"

  - name: stg_patient
    description: "Core patient information"
    columns:
      - name: patient_id
        description: "Primary key for patient records"
        tests:
          - unique
          - not_null
      - name: primary_provider_id
        description: "Foreign key to primary provider"
        tests:
          - relationships:
              to: ref('stg_provider')
              field: provider_id
      - name: fee_schedule_id
        description: "Foreign key to fee schedule"
        tests:
          - relationships:
              to: ref('stg_feesched')
              field: fee_schedule_id
      - name: clinic_id
        description: "Foreign key to clinic"
      - name: patient_status
        description: "Current status of the patient"
      - name: balance_total
        description: "Total outstanding balance"
      - name: insurance_estimate
        description: "Estimated insurance portion"
      - name: first_visit_date
        description: "Date of patient's first visit"

  - name: stg_patientlink
    description: "Links between related patient records"
    columns:
      - name: patient_link_id
        description: "Primary key for patient links"
        tests:
          - unique
          - not_null
      - name: from_patient_id
        description: "Foreign key to source patient"
        tests:
          - relationships:
              to: ref('stg_patient')
              field: patient_id
      - name: to_patient_id
        description: "Foreign key to target patient"
        tests:
          - relationships:
              to: ref('stg_patient')
              field: patient_id
      - name: link_created_datetime
        description: "When the patient link was created"
        tests:
          - not_null

  - name: stg_patientnote
    description: "Patient-related notes and preferences, excluding PHI content"
    columns:
      - name: patient_id
        description: "Primary key - foreign key to patient"
        tests:
          - unique
          - not_null
          - relationships:
              to: ref('stg_patient')
              field: patient_id
      - name: consent_flag
        description: "Patient consent status"
      - name: pronoun_preference
        description: "Patient's preferred pronouns"
      - name: ortho_months_treatment_override
        description: "Override for orthodontic treatment duration"

  - name: stg_patplan
    description: "Patient insurance plan assignments"
    columns:
      - name: patient_plan_id
        description: "Primary key for patient plans"
        tests:
          - unique
          - not_null
      - name: patient_id
        description: "Foreign key to patient"
        tests:
          - relationships:
              to: ref('stg_patient')
              field: patient_id
      - name: insurance_subscriber_id
        description: "Foreign key to insurance subscriber"
        tests:
          - relationships:
              to: ref('stg_inssub')
              field: insurance_subscriber_id
      - name: plan_order
        description: "Order of insurance plans (primary, secondary, etc.)"
      - name: is_pending_flag
        description: "Indicates if plan assignment is pending"

  - name: stg_payment
    description: "Payment transactions"
    columns:
      - name: payment_id
        description: "Primary key for payments"
        tests:
          - unique
          - not_null
      - name: patient_id
        description: "Foreign key to patient"
        tests:
          - relationships:
              to: ref('stg_patient')
              field: patient_id
      - name: payment_amount
        description: "Amount of the payment"
        tests:
          - not_null
      - name: payment_date
        description: "Date payment was made"
        tests:
          - not_null
      - name: payment_status
        description: "Current status of the payment"
      - name: is_recurring_cc_flag
        description: "Indicates if payment is part of recurring credit card charges"

  - name: stg_payperiod
    description: "Pay period definitions"
    columns:
      - name: pay_period_id
        description: "Primary key for pay periods"
        tests:
          - unique
          - not_null
      - name: start_date
        description: "Start date of pay period"
        tests:
          - not_null
      - name: end_date
        description: "End date of pay period"
        tests:
          - not_null
      - name: paycheck_date
        description: "Date paychecks are issued"

  - name: stg_payplan
    description: "Payment plan configuration and terms"
    columns:
      - name: payment_plan_id
        description: "Primary key for payment plans"
        tests:
          - unique
          - not_null
      - name: patient_id
        description: "Foreign key to patient"
        tests:
          - relationships:
              to: ref('stg_patient')
              field: patient_id
      - name: payment_plan_date
        description: "Date the payment plan was created"
        tests:
          - not_null
      - name: apr
        description: "Annual Percentage Rate for the payment plan"
      - name: number_of_payments
        description: "Total number of scheduled payments"
      - name: payment_amount
        description: "Amount per payment"
      - name: is_closed
        description: "Indicates if payment plan is closed"

  - name: stg_paysplit
    description: "Payment split allocations"
    columns:
      - name: payment_split_id
        description: "Primary key for payment splits"
        tests:
          - unique
          - not_null
      - name: payment_id
        description: "Foreign key to payment"
        tests:
          - relationships:
              to: ref('stg_payment')
              field: payment_id
      - name: patient_id
        description: "Foreign key to patient"
        tests:
          - relationships:
              to: ref('stg_patient')
              field: patient_id
      - name: split_amount
        description: "Amount of the split"
        tests:
          - not_null
      - name: payment_date
        description: "Date of the payment split"
        tests:
          - not_null

  - name: stg_perioexam
    description: "Periodontal examination records"
    columns:
      - name: periodontal_exam_id
        description: "Primary key for periodontal exams"
        tests:
          - unique
          - not_null
      - name: patient_id
        description: "Foreign key to patient"
        tests:
          - relationships:
              to: ref('stg_patient')
              field: patient_id
      - name: provider_id
        description: "Foreign key to provider"
        tests:
          - relationships:
              to: ref('stg_provider')
              field: provider_id
      - name: exam_date
        description: "Date of the periodontal exam"
        tests:
          - not_null

  - name: stg_periomeasure
    description: "Periodontal measurements"
    columns:
      - name: periodontal_measure_id
        description: "Primary key for periodontal measurements"
        tests:
          - unique
          - not_null
      - name: periodontal_exam_id
        description: "Foreign key to periodontal exam"
        tests:
          - relationships:
              to: ref('stg_perioexam')
              field: periodontal_exam_id
      - name: tooth_number
        description: "Tooth number being measured"
        tests:
          - not_null
      - name: mesial_buccal_value
        description: "Measurement at mesial buccal position"
      - name: buccal_value
        description: "Measurement at buccal position"
      - name: distal_buccal_value
        description: "Measurement at distal buccal position"

  - name: stg_pharmacy
    description: "Pharmacy information and locations"
    columns:
      - name: pharmacy_id
        description: "Primary key for pharmacies"
        tests:
          - unique
          - not_null
      - name: pharmacy_external_id
        description: "External identifier for the pharmacy"
      - name: store_name
        description: "Name of the pharmacy"
        tests:
          - not_null
      - name: phone_number
        description: "Pharmacy contact phone number"
      - name: state
        description: "State where pharmacy is located"

  - name: stg_pharmclinic
    description: "Relationships between pharmacies and clinics"
    columns:
      - name: pharmacy_clinic_id
        description: "Primary key for pharmacy-clinic relationships"
        tests:
          - unique
          - not_null
      - name: pharmacy_id
        description: "Foreign key to pharmacy"
        tests:
          - relationships:
              to: ref('stg_pharmacy')
              field: pharmacy_id
      - name: clinic_id
        description: "Foreign key to clinic"

  - name: stg_procedurecode
    description: "Dental procedure codes and definitions"
    columns:
      - name: procedure_code_id
        description: "Primary key for procedure codes"
        tests:
          - unique
          - not_null
      - name: procedure_code
        description: "Standard procedure code identifier"
        tests:
          - not_null
      - name: description
        description: "Full description of the procedure"
      - name: procedure_time
        description: "Standard time allocation for procedure"
      - name: is_hygiene_flag
        description: "Indicates if procedure is hygiene-related"
      - name: treatment_area
        description: "Area of mouth where procedure is performed"
      - name: procedure_category_id
        description: "Category classification for the procedure"

  - name: stg_procedurelog
    description: "Record of performed dental procedures"
    columns:
      - name: procedure_id
        description: "Primary key for procedures"
        tests:
          - unique
          - not_null
      - name: patient_id
        description: "Foreign key to patient"
        tests:
          - relationships:
              to: ref('stg_patient')
              field: patient_id
      - name: provider_id
        description: "Foreign key to provider"
        tests:
          - relationships:
              to: ref('stg_provider')
              field: provider_id
      - name: procedure_code_id
        description: "Foreign key to procedure code"
        tests:
          - relationships:
              to: ref('stg_procedurecode')
              field: procedure_code_id
      - name: procedure_date
        description: "Date procedure was performed"
        tests:
          - not_null
      - name: procedure_fee
        description: "Fee charged for the procedure"
      - name: tooth_number
        description: "Tooth number involved in procedure"
      - name: surface
        description: "Tooth surface involved in procedure"
      - name: procedure_status
        description: "Current status of the procedure"
      - name: completion_date
        description: "Date procedure was completed"

  - name: stg_procgroupitem
    description: "Groups of related dental procedures"
    columns:
      - name: procedure_group_item_id
        description: "Primary key for procedure group items"
        tests:
          - unique
          - not_null
      - name: procedure_id
        description: "Foreign key to procedure"
        tests:
          - relationships:
              to: ref('stg_procedurelog')
              field: procedure_id
      - name: group_id
        description: "Foreign key to procedure group"

  - name: stg_procmultivisit
    description: "Tracking for procedures requiring multiple visits"
    columns:
      - name: procedure_multi_visit_id
        description: "Primary key for multi-visit procedures"
        tests:
          - unique
          - not_null
      - name: group_multi_visit_id
        description: "Identifier for grouped multi-visit procedures"
      - name: procedure_id
        description: "Foreign key to procedure"
        tests:
          - relationships:
              to: ref('stg_procedurelog')
              field: procedure_id
      - name: patient_id
        description: "Foreign key to patient"
        tests:
          - relationships:
              to: ref('stg_patient')
              field: patient_id
      - name: procedure_status
        description: "Current status of the multi-visit procedure"
      - name: is_in_process_flag
        description: "Indicates if procedure is currently in progress"

  - name: stg_procnote
    description: "Clinical notes for procedures"
    columns:
      - name: procedure_note_id
        description: "Primary key for procedure notes"
        tests:
          - unique
          - not_null
      - name: procedure_id
        description: "Foreign key to procedure"
        tests:
          - relationships:
              to: ref('stg_procedurelog')
              field: procedure_id
      - name: patient_id
        description: "Foreign key to patient"
        tests:
          - relationships:
              to: ref('stg_patient')
              field: patient_id
      - name: user_id
        description: "User who created the note"
      - name: entry_datetime
        description: "When the note was created"
        tests:
          - not_null
      - name: is_topaz_signature_flag
        description: "Indicates if note has Topaz signature"

  - name: stg_proctp
    description: "Treatment plan procedures"
    columns:
      - name: treatment_plan_procedure_id
        description: "Primary key for treatment plan procedures"
        tests:
          - unique
          - not_null
      - name: treatment_plan_id
        description: "Foreign key to treatment plan"
      - name: patient_id
        description: "Foreign key to patient"
        tests:
          - relationships:
              to: ref('stg_patient')
              field: patient_id
      - name: provider_id
        description: "Foreign key to provider"
        tests:
          - relationships:
              to: ref('stg_provider')
              field: provider_id
      - name: procedure_code
        description: "Code identifying the planned procedure"
        tests:
          - not_null
      - name: tooth_number
        description: "Tooth number for the planned procedure"
      - name: priority
        description: "Priority level of the planned procedure"
      - name: fee_amount
        description: "Planned fee for the procedure"
      - name: primary_insurance_amount
        description: "Expected primary insurance coverage"
      - name: patient_amount
        description: "Expected patient portion"
      - name: treatment_plan_date
        description: "Date procedure was added to treatment plan"
        tests:
          - not_null

  - name: stg_program
    description: "External program configurations and integrations"
    columns:
      - name: program_id
        description: "Primary key for program configurations"
        tests:
          - unique
          - not_null
      - name: program_name
        description: "Name of the configured program"
        tests:
          - not_null
      - name: is_enabled_flag
        description: "Indicates if program is currently enabled"
      - name: is_disabled_by_hq_flag
        description: "Indicates if program is disabled by headquarters"
      - name: program_path
        description: "File system path to the program"
      - name: plugin_dll_name
        description: "Name of associated plugin DLL"

  - name: stg_programproperty
    description: "Configuration properties for external programs"
    columns:
      - name: program_property_id
        description: "Primary key for program properties"
        tests:
          - unique
          - not_null
      - name: program_id
        description: "Foreign key to program"
        tests:
          - relationships:
              to: ref('stg_program')
              field: program_id
      - name: clinic_id
        description: "Foreign key to clinic"
      - name: property_description
        description: "Description of the property"
      - name: is_high_security_flag
        description: "Indicates if property contains sensitive data"

  - name: stg_provider
    description: "Healthcare provider information"
    columns:
      - name: provider_id
        description: "Primary key for providers"
        tests:
          - unique
          - not_null
      - name: provider_abbreviation
        description: "Provider's abbreviated identifier"
      - name: fee_schedule_id
        description: "Foreign key to fee schedule"
        tests:
          - relationships:
              to: ref('stg_feesched')
              field: fee_schedule_id
      - name: specialty_id
        description: "Provider's dental specialty"
      - name: provider_status
        description: "Current status of the provider"
      - name: is_hidden_flag
        description: "Indicates if provider is hidden from active use"
      - name: is_instructor_flag
        description: "Indicates if provider is an instructor"
      - name: hourly_production_goal
        description: "Target hourly production amount"
      - name: termination_date
        description: "Date provider was terminated, if applicable"

  - name: stg_recall
    description: "Patient recall scheduling and tracking"
    columns:
      - name: recall_id
        description: "Primary key for recall records"
        tests:
          - unique
          - not_null
      - name: patient_id
        description: "Foreign key to patient"
        tests:
          - relationships:
              to: ref('stg_patient')
              field: patient_id
      - name: recall_type_id
        description: "Type of recall"
      - name: calculated_due_date
        description: "System-calculated next due date"
      - name: due_date
        description: "Actual due date for recall"
        tests:
          - not_null
      - name: scheduled_date
        description: "Date recall appointment is scheduled"
      - name: interval_days
        description: "Days between recall appointments"
      - name: status_id
        description: "Current status of recall"
      - name: is_disabled_flag
        description: "Indicates if recall is disabled"
      - name: priority
        description: "Priority level of recall"

  - name: stg_recalltrigger
    description: "Links between recall types and triggering procedures"
    columns:
      - name: recall_trigger_id
        description: "Primary key for recall triggers"
        tests:
          - unique
          - not_null
      - name: recall_type_id
        description: "Foreign key to recall type"
        tests:
          - relationships:
              to: ref('stg_recalltype')
              field: recall_type_id
      - name: procedure_code_id
        description: "Foreign key to procedure code"
        tests:
          - relationships:
              to: ref('stg_procedurecode')
              field: procedure_code_id

  - name: stg_recalltype
    description: "Definitions of different recall types"
    columns:
      - name: recall_type_id
        description: "Primary key for recall types"
        tests:
          - unique
          - not_null
      - name: recall_type_description
        description: "Description of the recall type"
        tests:
          - not_null
      - name: default_interval_days
        description: "Default number of days between recalls"
      - name: time_pattern
        description: "Standard time pattern for recall appointments"
      - name: procedure_codes
        description: "Associated procedure codes"

  - name: stg_refattach
    description: "Referral attachments and procedure links"
    columns:
      - name: referral_attachment_id
        description: "Primary key for referral attachments"
        tests:
          - unique
          - not_null
      - name: referral_id
        description: "Foreign key to referral"
        tests:
          - relationships:
              to: ref('stg_referral')
              field: referral_id
      - name: patient_id
        description: "Foreign key to patient"
        tests:
          - relationships:
              to: ref('stg_patient')
              field: patient_id
      - name: procedure_id
        description: "Foreign key to procedure"
        tests:
          - relationships:
              to: ref('stg_procedurelog')
              field: procedure_id
      - name: referral_type
        description: "Type of referral"
      - name: referral_date
        description: "Date of referral"
        tests:
          - not_null
      - name: is_transition_of_care_flag
        description: "Indicates if referral is for transition of care"

  - name: stg_referral
    description: "Healthcare provider referral information"
    columns:
      - name: referral_id
        description: "Primary key for referrals"
        tests:
          - unique
          - not_null
      - name: business_name
        description: "Name of referral business"
      - name: specialty_id
        description: "Specialty of the referral provider"
      - name: is_doctor_flag
        description: "Indicates if referral is to a doctor"
      - name: is_preferred_flag
        description: "Indicates if this is a preferred referral provider"
      - name: is_hidden_flag
        description: "Indicates if referral is hidden from active use"
      - name: patient_id
        description: "Foreign key to patient if referral is patient-specific"
        tests:
          - relationships:
              to: ref('stg_patient')
              field: patient_id

  - name: stg_rxdef
    description: "Prescription definition templates"
    columns:
      - name: prescription_definition_id
        description: "Primary key for prescription definitions"
        tests:
          - unique
          - not_null
      - name: drug_name
        description: "Name of the drug"
        tests:
          - not_null
      - name: rx_cui_code
        description: "RxNorm concept unique identifier"
      - name: is_controlled_substance_flag
        description: "Indicates if drug is a controlled substance"
      - name: is_procedure_required_flag
        description: "Indicates if procedure is required for prescription"
      - name: dispense_instructions
        description: "Instructions for dispensing medication"

  - name: stg_rxnorm
    description: "RxNorm drug terminology reference"
    columns:
      - name: rxnorm_id
        description: "Primary key for RxNorm records"
        tests:
          - unique
          - not_null
      - name: rx_cui_code
        description: "RxNorm concept unique identifier"
        tests:
          - not_null
      - name: drug_description
        description: "Description of the drug"
      - name: mmsl_code
        description: "Master Medicinal Substance List code"

  - name: stg_rxpat
    description: "Patient prescription records"
    columns:
      - name: prescription_id
        description: "Primary key for prescriptions"
        tests:
          - unique
          - not_null
      - name: patient_id
        description: "Foreign key to patient"
        tests:
          - relationships:
              to: ref('stg_patient')
              field: patient_id
      - name: provider_id
        description: "Foreign key to provider"
        tests:
          - relationships:
              to: ref('stg_provider')
              field: provider_id
      - name: pharmacy_id
        description: "Foreign key to pharmacy"
        tests:
          - relationships:
              to: ref('stg_pharmacy')
              field: pharmacy_id
      - name: prescription_date
        description: "Date prescription was written"
        tests:
          - not_null
      - name: days_supply
        description: "Number of days of medication supplied"
      - name: is_controlled_substance_flag
        description: "Indicates if drug is a controlled substance"
      - name: send_status
        description: "Status of prescription transmission"

  - name: stg_schedule
    description: "Provider and employee scheduling"
    columns:
      - name: schedule_id
        description: "Primary key for schedule entries"
        tests:
          - unique
          - not_null
      - name: provider_id
        description: "Foreign key to provider"
        tests:
          - relationships:
              to: ref('stg_provider')
              field: provider_id
      - name: employee_id
        description: "Foreign key to employee"
      - name: schedule_date
        description: "Date of schedule entry"
        tests:
          - not_null
      - name: start_time
        description: "Start time of schedule block"
        tests:
          - not_null
      - name: stop_time
        description: "End time of schedule block"
        tests:
          - not_null
      - name: schedule_type
        description: "Type of schedule entry"
      - name: schedule_status
        description: "Current status of schedule entry"

  - name: stg_scheduleop
    description: "Links between schedules and operatories"
    columns:
      - name: schedule_operatory_id
        description: "Primary key for schedule-operatory relationships"
        tests:
          - unique
          - not_null
      - name: schedule_id
        description: "Foreign key to schedule"
        tests:
          - relationships:
              to: ref('stg_schedule')
              field: schedule_id
      - name: operatory_id
        description: "Foreign key to operatory"
        tests:
          - not_null

  - name: stg_sheet
    description: "Form sheets and document templates"
    columns:
      - name: sheet_id
        description: "Primary key for sheets"
        tests:
          - unique
          - not_null
      - name: patient_id
        description: "Foreign key to patient"
        tests:
          - relationships:
              to: ref('stg_patient')
              field: patient_id
      - name: sheet_type
        description: "Type of sheet or form"
      - name: sheet_description
        description: "Description of the sheet's purpose"
      - name: is_web_form_flag
        description: "Indicates if sheet is a web form"
      - name: is_deleted_flag
        description: "Indicates if sheet has been deleted"
      - name: sheet_datetime
        description: "When the sheet was created"
        tests:
          - not_null
      - name: last_edited_datetime
        description: "When the sheet was last modified"

  - name: stg_sheetfield
    description: "Individual fields within form sheets"
    columns:
      - name: sheet_field_id
        description: "Primary key for sheet fields"
        tests:
          - unique
          - not_null
      - name: sheet_id
        description: "Foreign key to sheet"
        tests:
          - relationships:
              to: ref('stg_sheet')
              field: sheet_id
      - name: field_definition_id
        description: "Foreign key to field definition"
        tests:
          - relationships:
              to: ref('stg_sheetfielddef')
              field: field_definition_id
      - name: field_type
        description: "Type of field"
        tests:
          - not_null
      - name: field_name
        description: "Name of the field"
      - name: is_required_flag
        description: "Indicates if field is required"
      - name: is_locked_flag
        description: "Indicates if field is locked"
      - name: signature_datetime
        description: "When field was electronically signed"
      - name: can_sign_electronically_flag
        description: "Indicates if field can be signed electronically"

  - name: stg_sheetfielddef
    description: "Definitions for form sheet fields"
    columns:
      - name: field_definition_id
        description: "Primary key for field definitions"
        tests:
          - unique
          - not_null
      - name: sheet_definition_id
        description: "Foreign key to sheet definition"
        tests:
          - not_null
      - name: field_type
        description: "Type of field"
        tests:
          - not_null
      - name: field_name
        description: "Name of the field"
      - name: default_value
        description: "Default value for the field"
      - name: is_required_flag
        description: "Indicates if field is required"
      - name: is_payment_option_flag
        description: "Indicates if field is for payment options"
      - name: language_code
        description: "Language code for field text"
      - name: can_sign_electronically_flag
        description: "Indicates if field can be signed electronically"

  - name: stg_statement
    description: "Patient billing statements and invoices"
    columns:
      - name: statement_id
        description: "Primary key for statements"
        tests:
          - unique
          - not_null
      - name: patient_id
        description: "Foreign key to patient"
        tests:
          - relationships:
              to: ref('stg_patient')
              field: patient_id
      - name: sent_date
        description: "Date statement was sent"
      - name: date_range_start
        description: "Start of statement period"
      - name: date_range_end
        description: "End of statement period"
      - name: statement_mode
        description: "Mode of statement delivery"
      - name: statement_type
        description: "Type of statement"
      - name: is_sent_flag
        description: "Indicates if statement has been sent"
      - name: is_invoice_flag
        description: "Indicates if statement is an invoice"
      - name: total_balance
        description: "Total balance on statement"
      - name: insurance_estimate
        description: "Estimated insurance portion"
      - name: is_balance_valid_flag
        description: "Indicates if balance is valid"

  - name: stg_statementprod
    description: "Production items included in statements"
    columns:
      - name: statement_production_id
        description: "Primary key for statement production items"
        tests:
          - unique
          - not_null
      - name: statement_id
        description: "Foreign key to statement"
        tests:
          - relationships:
              to: ref('stg_statement')
              field: statement_id
      - name: production_type
        description: "Type of production item"
        tests:
          - not_null
      - name: document_id
        description: "Foreign key to document"
      - name: late_charge_adjustment_id
        description: "Foreign key to late charge adjustment"

  - name: stg_task
    description: "Task management and tracking"
    columns:
      - name: task_id
        description: "Primary key for tasks"
        tests:
          - unique
          - not_null
      - name: task_list_id
        description: "Foreign key to task list"
      - name: user_id
        description: "User assigned to the task"
      - name: task_status
        description: "Current status of the task"
      - name: is_repeating_flag
        description: "Indicates if task repeats"
      - name: task_date
        description: "Due date of the task"
        tests:
          - not_null
      - name: entry_datetime
        description: "When task was created"
        tests:
          - not_null
      - name: finished_datetime
        description: "When task was completed"
      - name: reminder_type
        description: "Type of reminder set for task"
      - name: reminder_frequency
        description: "Frequency of task reminders"

  - name: stg_timeadjust
    description: "Employee time and attendance adjustments"
    columns:
      - name: time_adjustment_id
        description: "Primary key for time adjustments"
        tests:
          - unique
          - not_null
      - name: employee_id
        description: "Foreign key to employee"
        tests:
          - not_null
      - name: clinic_id
        description: "Foreign key to clinic"
      - name: regular_hours
        description: "Regular hours adjusted"
      - name: overtime_hours
        description: "Overtime hours adjusted"
      - name: pto_hours
        description: "PTO hours adjusted"
      - name: is_automatic_flag
        description: "Indicates if adjustment was automatic"
      - name: is_unpaid_protected_leave_flag
        description: "Indicates if adjustment is for protected unpaid leave"
      - name: entry_datetime
        description: "When adjustment was entered"
        tests:
          - not_null
      - name: created_by_user_id
        description: "User who created the adjustment"

  - name: stg_toothinitial
    description: "Initial tooth conditions and charting"
    columns:
      - name: tooth_initial_id
        description: "Primary key for initial tooth conditions"
        tests:
          - unique
          - not_null
      - name: patient_id
        description: "Foreign key to patient"
        tests:
          - relationships:
              to: ref('stg_patient')
              field: patient_id
      - name: tooth_number
        description: "Tooth number being documented"
        tests:
          - not_null
      - name: initial_condition_type
        description: "Type of initial tooth condition"
      - name: movement_value
        description: "Tooth movement measurement"
      - name: drawing_segment
        description: "Segment information for tooth drawing"
      - name: drawing_color
        description: "Color used in tooth drawing"
      - name: created_at
        description: "When the record was created"
        tests:
          - not_null

  - name: stg_treatplan
    description: "Treatment plans for dental procedures"
    columns:
      - name: treatment_plan_id
        description: "Primary key for treatment plans"
        tests:
          - unique
          - not_null
      - name: patient_id
        description: "Foreign key to patient"
        tests:
          - relationships:
              to: ref('stg_patient')
              field: patient_id
      - name: created_by_user_id
        description: "User who created the treatment plan"
      - name: presenter_user_id
        description: "User who presented the treatment plan"
      - name: treatment_plan_type
        description: "Type of treatment plan"
      - name: treatment_plan_status
        description: "Current status of treatment plan"
      - name: is_topaz_signature_flag
        description: "Indicates if plan has Topaz signature"
      - name: treatment_plan_date
        description: "Date plan was created"
        tests:
          - not_null
      - name: patient_signed_datetime
        description: "When patient signed the plan"
      - name: practice_signed_datetime
        description: "When practice signed the plan"

  - name: stg_treatplanattach
    description: "Links between treatment plans and procedures"
    columns:
      - name: treatment_plan_attachment_id
        description: "Primary key for treatment plan attachments"
        tests:
          - unique
          - not_null
      - name: treatment_plan_id
        description: "Foreign key to treatment plan"
        tests:
          - relationships:
              to: ref('stg_treatplan')
              field: treatment_plan_id
      - name: procedure_id
        description: "Foreign key to procedure"
        tests:
          - relationships:
              to: ref('stg_procedurelog')
              field: procedure_id
      - name: priority_id
        description: "Priority level for the procedure"

  - name: stg_treatplanparam
    description: "Display parameters for treatment plans"
    columns:
      - name: treatment_plan_parameter_id
        description: "Primary key for treatment plan parameters"
        tests:
          - unique
          - not_null
      - name: patient_id
        description: "Foreign key to patient"
        tests:
          - relationships:
              to: ref('stg_patient')
              field: patient_id
      - name: treatment_plan_id
        description: "Foreign key to treatment plan"
        tests:
          - relationships:
              to: ref('stg_treatplan')
              field: treatment_plan_id
      - name: show_fees_flag
        description: "Indicates if fees should be displayed"
      - name: show_insurance_flag
        description: "Indicates if insurance information should be displayed"
      - name: show_discount_flag
        description: "Indicates if discounts should be displayed"
      - name: show_totals_flag
        description: "Indicates if totals should be displayed"
      - name: show_completed_procedures_flag
        description: "Indicates if completed procedures should be displayed"

  - name: stg_usergroup
    description: "User group definitions and hierarchies"
    columns:
      - name: user_group_id
        description: "Primary key for user groups"
        tests:
          - unique
          - not_null
      - name: user_group_description
        description: "Description of the user group"
      - name: parent_user_group_id
        description: "Foreign key to parent user group"
        tests:
          - relationships:
              to: ref('stg_usergroup')
              field: user_group_id

  - name: stg_usergroupattach
    description: "Links between users and their assigned groups"
    columns:
      - name: user_group_attachment_id
        description: "Primary key for user group attachments"
        tests:
          - unique
          - not_null
      - name: user_id
        description: "Foreign key to user"
        tests:
          - relationships:
              to: ref('stg_userod')
              field: user_id
      - name: user_group_id
        description: "Foreign key to user group"
        tests:
          - relationships:
              to: ref('stg_usergroup')
              field: user_group_id

  - name: stg_userod
    description: "User accounts and settings"
    columns:
      - name: user_id
        description: "Primary key for users"
        tests:
          - unique
          - not_null
      - name: username
        description: "User's login name"
        tests:
          - not_null
      - name: is_hidden_flag
        description: "Indicates if user is hidden from active use"
      - name: user_group_id
        description: "Foreign key to primary user group"
        tests:
          - relationships:
              to: ref('stg_usergroup')
              field: user_group_id
      - name: employee_id
        description: "Foreign key to employee"
      - name: clinic_id
        description: "Foreign key to clinic"
      - name: provider_id
        description: "Foreign key to provider"
        tests:
          - relationships:
              to: ref('stg_provider')
              field: provider_id
      - name: clinic_restricted_flag
        description: "Indicates if user is restricted to specific clinic"
      - name: password_is_strong_flag
        description: "Indicates if password meets strength requirements"
      - name: password_reset_required_flag
        description: "Indicates if password reset is required"
      - name: login_failed_attempts
        description: "Number of failed login attempts"
      - name: last_successful_login_at
        description: "Timestamp of last successful login"

  - name: stg_zipcode
    description: "Postal code reference data"
    columns:
      - name: zipcode_id
        description: "Primary key for zipcode records"
        tests:
          - unique
          - not_null
      - name: zipcode
        description: "Postal code digits"
        tests:
          - not_null
      - name: city_name
        description: "City name associated with zipcode"
      - name: state_code
        description: "State code associated with zipcode"
      - name: is_frequent_flag
        description: "Indicates if zipcode is frequently used"
